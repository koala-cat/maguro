<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Bar Example</title>
  <script type="text/javascript" src="../node_modules/vue/dist/vue.js"></script>
  <script type="text/javascript" src="../node_modules/mussel/dist/mussel.js"></script>
  <script type="text/javascript" src="../node_modules/a-color-picker/dist/acolorpicker.js"></script>
  <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&amp;ak=471Ih7dPPTucwZXZxlq5ax52Hb71FhZ8"></script>
  <script type="text/javascript" src="https://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager.js"></script>
  <script type="text/javascript" src="../dist/maguro.js"></script>
</head>

<body class="mu-background-normal">
  <div id="app">
    <h2>Map Example</h2>
    <hr>
    <maguro
      :base-map-visible="false"
      :map-events="events"
      :map-legends="legends"
      :map-overlays="overlays"
      :map-structures="structures"
      @save="saveOverlays">
      <maguro-toolkit>
        <mu-button
          button-style="text"
          @click="onUploadPolyline">
          <span style="font-size: 14px;">+</span>
          导入线路
        </mu-button>
      </maguro-toolkit>
      <maguro-overlay-toolkit></maguro-overlay-toolkit>
      <!-- <maguro-overlay-list
        :source-column-visible="false">
      </maguro-overlay-list>
      <maguro-overlay-form></maguro-overlay-form> -->
    </maguro>
  </div>

  <script type="text/javascript">
    var app = new Vue({
      el: '#app',
      data: {
        events: {},
        legends: [
          {
            id: 1008,
            type: 'marker',
            value: 'marker',
            disabled: true,
            iconUrl: "./assets/images/s1.svg"
          },
          {
            id: 1009,
            type: 'marker',
            value: 'marker',
            disabled: true,
            iconUrl: "./assets/images/s2.svg"
          },
          {
            type: 'marker',
            disabled: true,
            value: 'create'
          },
          {
            id: 1013,
            type: 'polyline',
            value: 'solid',
            disabled: true,
            isRemoved: false
          },
          {
            id: 1016,
            type: 'polygon',
            value: 'circle',
            disabled: true,
            isRemoved: false
          },
          {
            id: 1017,
            type: 'polygon',
            value: 'rectangle',
            disabled: true,
            isRemoved: false
          },
          {
            id: 1018,
            type: 'polygon',
            value: 'polygon',
            disabled: true,
            isRemoved: false
          },
          {
            id: 1019,
            type: 'special',
            value: 'specialDoubleLine',
            disabled: true,
            isRemoved: false
          }
        ],
        overlays: [],
        structures: [
          {
            id: 10001,
            name: '性能',
            projectStructureCategoryId: null,
            categoryName: null
          },
          {
            id: 10002,
            name: '猫胖胖',
            projectStructureCategoryId: 1001,
            categoryName: '猫'
          },
          {
            id: 10003,
            name: '猫臭臭',
            projectStructureCategoryId: 1001,
            categoryName: '猫'
          }
        ],
        listVisible: true
      },
      mounted () {
        for (const item of this.legends) {
          if (!item.iconUrl) continue
          try {
            let xmlhttp = null
            if (window.XMLHttpRequest) {
              xmlhttp = new XMLHttpRequest()
            } else {
              xmlhttp = new window.ActiveXObject('Microsoft.XMLHTTP')
            }
            xmlhttp.open('GET', item.iconUrl, false)
            xmlhttp.send(null)
            const xmlDoc = xmlhttp.responseXML.documentElement
            item.svg = xmlDoc
          } catch (err) {
            console.log(err)
          }
        }

        this.events = {
          mouseover: (e, overlay) => {
            console.log('mouseover')
          }
        }

        this.overlays.push(
          {
            id: 102,
            name: '线',
            points: [
              {
                longitude: 111.08588591379404,
                latitude: 29.119196829827867
              },
              {
                longitude: 111.15588591379404,
                latitude: 29.129196829827867
              }
            ],
            projectMapLegendId: 1013,
            visible: true,
            disabled: false
          },
          {
            id: 101,
            name: '圆形',
            width: 280,
            points: [
              {
                longitude: 111.05588591379404,
                latitude: 29.119196829827867
              }
            ],
            projectMapLegendId: 1016,
            visible: true,
            disabled: false
          }
        )
      },
      methods: {
        onUploadPolyline () {
          // 要提供drawuploadline
          console.log('upload')
        },
        saveOverlays (result) {
          console.log(result)
        }
      }
    });
  </script>
</body>

</html>
